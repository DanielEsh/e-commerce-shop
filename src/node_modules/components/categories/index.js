import React from 'react'
import {connect} from 'react-redux'
import {withRouter} from 'react-router'
import {compose} from 'redux'
import {Link} from 'react-router-dom'
import classNames from 'classnames'
import * as R from 'ramda'

import {getCategories, getActiveCategoryId} from 'selectors'

const Categories = ({categories, activeCategoryId}) => {

  const renderCategory = (category, index) => {
    const getActiveState = R.propEq('id', activeCategoryId)
    const linkClass = classNames({
      'nav-item': true,
      'active': getActiveState(category)
    })
    return (
        <li key={index} className={linkClass}>
          <Link
            to={`/categories/${category.id}`}

          >
            {category.name}
          </Link>
        </li>
    )
  }

  const renderAllCategory = () => {
    const linkClass = classNames({
      'nav-item': true,
      'active': R.isNil(activeCategoryId)
    })
    return (
        <li className={linkClass}>
          <Link
            to='/'

          >
            Все категории
          </Link>
        </li>
    )
  }

  return (
    <nav className='navigation'>
      <div className="container">
        <div className='responsive-nav'>
          <ul className='main-nav nav navbar-nav'>
            {renderAllCategory()}
            {categories.map((category, index) => renderCategory(category, index))}
          </ul>
        </div>
      </div>

    </nav>
  )
}

const mapStateToProps = (state, ownProps) => ({
  categories: getCategories(state),
  activeCategoryId: getActiveCategoryId(ownProps)
})

export default compose(
  withRouter,
  connect(mapStateToProps, null)
)(Categories)

