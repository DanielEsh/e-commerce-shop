import * as R from 'ramda'
import request from 'superagent'

const url = 'http://f0467448.xsph.ru' //spring host
// http://localhost:8080/electro

export const fetchPhones = async () => {
    const {body} = await request.get(
        `${url}/api/product/searche.php?s=`
    )
    return body.phones
}

export const fetchPhoneById = async (id) => {
    const {body} = await request.get(
        `${url}/api/product/read.php`
    )
    const phone = R.find(R.propEq('id', id), body.phones)
    return phone
}

export const fetchCategories = async () => {
    const {body} = await request.get(
        `${url}/api/category/read.php`
    )
    return body.categories
}

export const fetchGroups = async () => {
    const {body} = await request.get(
        `${url}/api/groups/read.php`
    )
    return body.groups
}

export const searchPhones = async (search) => {
    console.log('Ассинхронный поиск')
    try {
        const {body} = await request.get(
            `${url}/api/product/searche.php?s=${search}`
        )
        console.log(body.phones)
        return body.phones
    } catch (e) {

        console.log('Ошибка', e,)
    }

}

export const searchPrice = async (searchPrice) => {
    console.log('Ассинхронный фильтр по цене', searchPrice)

    return fetch(`${url}/api/product/searchPrice.php`, {
        method: "POST",
        headers: ({
            Accept: 'application/json',
        }),
        body: JSON.stringify(searchPrice)
    })
        .then((response) => response.json())
        .then((data) => {
            return data.phones
        })
}

