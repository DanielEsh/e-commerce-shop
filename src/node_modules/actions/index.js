import {
    FETCH_PHONES_START,
    FETCH_PHONES_SUCCESS,
    FETCH_PHONES_FAILURE,
    FETCH_PHONES_BY_ID_FAILURE,
    FETCH_PHONES_BY_ID_START,
    FETCH_PHONES_BY_ID_SUCCESS,
    ADD_PHONE_TO_BASKET,
    SEARCH_PHONE_START,
    SEARCH_PHONE_SUCCESS,
    SEARCH_PHONE_FAILURE,
    FETCH_CATEGORIES_FAILURE,
    FETCH_CATEGORIES_START,
    FETCH_CATEGORIES_SUCCESS,
    REMOVE_PHONE_FROM_BASKET,
    CLEAN_BASKET,
    SEARCH_PRICE_START,
    SEARCH_PRICE_SUCCESS,
    SEARCH_PRICE_FAILURE,
    ADD_PHONE_TO_WISHLIST,
    REMOVE_PHONE_FROM_WISHLIST,
    CLEAN_WISHLIST,
    FETCH_GROUPS_START,
    FETCH_GROUPS_SUCCESS,
    FETCH_GROUPS_FAILURE,
} from 'actionTypes'
import {
    fetchPhones as fetchPhonesApi,
    fetchPhoneById as fetchPhoneByIdApi,
    fetchCategories as fetchCategoriesApi,
    fetchGroups as fetchGroupsApi,
    searchPhones as searchPhonesApi,
    searchPrice as searchPriceApi
} from 'api'


export const fetchPhones = () => async dispatch => {
    dispatch({type: FETCH_PHONES_START})

    try {
        const phones = await fetchPhonesApi()
        dispatch({
            type: FETCH_PHONES_SUCCESS,
            payload: phones
        })
    } catch (err) {
        dispatch({
            type: FETCH_PHONES_FAILURE,
            payload: err,
            error: true
        })
    }
}

export const fetchPhoneById = (id) => async dispatch => {
    dispatch({type: FETCH_PHONES_BY_ID_START})

    try {
        const phone = await fetchPhoneByIdApi(id)
        dispatch({
            type: FETCH_PHONES_BY_ID_SUCCESS,
            payload: phone
        })
    } catch (err) {
        dispatch({
            type: FETCH_PHONES_BY_ID_FAILURE,
            payload: err,
            error: true
        })
    }
}

export const addPhoneToBasket = id => dispatch => {
    dispatch({
        type: ADD_PHONE_TO_BASKET,
        payload: id
    })
}

export const addPhoneToWishlist = id => dispatch => {
    dispatch({
        type: ADD_PHONE_TO_WISHLIST,
        payload: id
    })
}


export const searchPhone = id => async dispatch => {
    dispatch({type: SEARCH_PHONE_START})

    try {
        const searchPhones = await searchPhonesApi(id)
        dispatch({
            type: SEARCH_PHONE_SUCCESS,
            payload: searchPhones
        })
    } catch (err) {
        dispatch({
            type: SEARCH_PHONE_FAILURE,
            payload: err,
            error: true
        })
    }
}

export const searchPrice = id => async dispatch => {
  // console.log('actions id', id)
  // console.log('actions dispatch', dispatch)
  dispatch({type: SEARCH_PRICE_START, payload:id}) //а нах payload?

  try {
    const searchPhones = await searchPriceApi(id)
    // const searchPhones = []
    console.log('searchPhones', searchPhones)
    dispatch({
      type: SEARCH_PRICE_SUCCESS,
      payload: searchPhones
    })
  } catch (err) {
    dispatch({
      type: SEARCH_PRICE_FAILURE,
      payload: err,
      error: true
    })
  }
}

export const fetchCategories = () => async dispatch => {
    dispatch({type: FETCH_CATEGORIES_START})

    try {
        const categories = await fetchCategoriesApi()
        dispatch({
            type: FETCH_CATEGORIES_SUCCESS,
            payload: categories
        })
    } catch (err) {
        dispatch({
            type: FETCH_CATEGORIES_FAILURE,
            payload: err,
            error: true
        })
    }
}

export const fetchGroups = () => async dispatch => {
    dispatch({type: FETCH_GROUPS_START})

    try {
        const group = await fetchGroupsApi()
        dispatch({
            type: FETCH_GROUPS_SUCCESS,
            payload: group
        })
    } catch (err) {
        dispatch({
            type: FETCH_GROUPS_FAILURE,
            payload: err,
            error: true
        })
    }
}

export const removePhoneFromBasket = id => async dispatch => {
    dispatch({
        type: REMOVE_PHONE_FROM_BASKET,
        payload: id
    })
}

export const removePhoneFromWishlist = id => async dispatch => {
    dispatch({
        type: REMOVE_PHONE_FROM_WISHLIST,
        payload: id
    })
}

export const cleanBasket = () => async dispatch => {
    dispatch({
        type: CLEAN_BASKET
    })
}
export const cleanWishlist = () => async dispatch => {
    dispatch({
        type: CLEAN_WISHLIST
    })
}

export const basketCheckout = phones => () => {
    alert(phones)
}


